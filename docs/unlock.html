<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Puma Unlock Demo</title>

  <script>
    
    window.unlockProtocolConfig = {    
      "pessimistic": true,    
      "network": 4,           
      "locks": {        
        "0x7f389Df70E090849ec32869E28fc33DC522108f7": {
          "name": "Puma lock priced in ETH. Free"
        },
        "0xE13d43323746c7fBC5994c59b9FC7B992a72d7c4": {
          "name": "Puma lock priced in PC (Puma Coin). Free"
        },
        "0x2B0ed09862Bb5BbC43DfcE2D29629a34EdC2B664":{
          "name": "Puma lock priced in ETH. Cost 0.0001"
        },
        "0x63A2AA0e9ff0dF21E362c7D6E79A2218767C1EDE":{
          "name": "Second Puma lock priced in ETH. Cost 0.0001"
        }
      },
      "icon": "https://test.puma.tech/puma_round_200.png",    
      "callToAction": {        
        "default": "Get the key on Rinkeby",
        "expired": "The lock has expired. Please renew",
        "metadata": "Please fill in the following:"   
      }
    }

    function logEvent(event){
      logTo(container, event)

      var locks = event.detail.locks
      locks.forEach(function(lock){
      	logString(container, lock) 
        if ( lock == "0x7f389Df70E090849ec32869E28fc33DC522108f7" ){
          logTo(container1, event)
        }
        if ( lock == "0xE13d43323746c7fBC5994c59b9FC7B992a72d7c4" ){
          logTo(container2, event)
        }
        if ( lock == "0x2B0ed09862Bb5BbC43DfcE2D29629a34EdC2B664"){
          logTo(container3, event)
        }
        if ( lock == "0x63A2AA0e9ff0dF21E362c7D6E79A2218767C1EDE"){
          logTo(container4, event)
        }
      })
    }

    function logTo(container, e){
      container.innerText = container.innerText + 
        "Event type:" + JSON.stringify(e.type, null, 2) + '\n' +
        "Event details" + JSON.stringify(e.detail, null, 2) + '\n\n';
      console.log(e);
    }
    
    function logString(container, s){
      container.innerText = container.innerText + 
        "String:" + s + '\n\n';
      console.log(s);
    }

    window.addEventListener('unlockProtocol.status', logEvent)
    window.addEventListener('unlockProtocol.authenticated', logEvent)
    window.addEventListener('unlockProtocol.transactionSent', logEvent)
  </script>

  <script>
    window.addEventListener("unlockProtocol.status", function (event){
      if (event.detail.state != "unlocked") {
      	return
      }
      
      //looks like array, but is a string
      var lock = event.detail.locks
      if ( lock == "0x7f389Df70E090849ec32869E28fc33DC522108f7" ){
      	lock1locked.style.display = "none"
        lock1unlocked.style.display = "block"
      }
      if ( lock == "0xE13d43323746c7fBC5994c59b9FC7B992a72d7c4" ){
      	lock2locked.style.display = "none"
        lock2unlocked.style.display = "block"
      }
      if ( lock == "0x2B0ed09862Bb5BbC43DfcE2D29629a34EdC2B664"){
        lock3locked.style.display = "none"
        lock3unlocked.style.display = "block"
      }
      if ( lock == "0x63A2AA0e9ff0dF21E362c7D6E79A2218767C1EDE"){
        lock4locked.style.display = "none"
        lock4unlocked.style.display = "block"
      }
      
      
    });
  
  </script>

  <style>
    body{
      font-family:sans-serif;
    }

    pre.container{
      background-color:lightgreen;
      padding:10px;
    }

    .error{
      display:none;
      background-color:pink;
      padding:10px;
    }
  </style>

</head>

<body>

<script src="https://paywall.unlock-protocol.com/static/unlock.latest.min.js" async=""></script>
<h1>Simple Unlock Demo</h1>

<h5>Puma lock priced in ETH (free)</h5>
<p id="lock1locked" >Lock 1 is locked ðŸ”’ </p>
<p id="lock1unlocked" style="display:none">Lock 1 is unlocked ðŸŽ‰</p>
<!-- container to display unlock events -->
<pre id="container1" class="container">
</pre>

<h5>Puma lock priced in PC (free)</h5>
<p id="lock2locked">Lock 2 is locked ðŸ”’ </p>
<p id="lock2unlocked" style="display:none">Lock 2 is unlocked ðŸŽ‰</p>
<!-- container to display unlock events -->
<pre id="container2" class="container">
</pre>

<h5>Puma lock priced in Eth (0.0001)</h5>
<p id="lock3locked">Lock 3 is locked ðŸ”’ </p>
<p id="lock3unlocked" style="display:none">Lock 3 is unlocked ðŸŽ‰</p>
<!-- container to display unlock events -->
<pre id="container3" class="container">
</pre>

<h5>Second Puma lock priced in Eth (0.0001)</h5>
<p id="lock4locked">Lock 4 is locked ðŸ”’ </p>
<p id="lock4unlocked" style="display:none">Lock 4 is unlocked ðŸŽ‰</p>

<!-- container to display unlock events -->
<pre id="container4" class="container">
</pre>

<p id="buy_button" onclick="window.unlockProtocol && window.unlockProtocol.loadCheckoutModal()"><button class="button">
    Unlock!
  </button></p>

 <h5>All events</h5> 
  <pre id="container" class="container">
  </pre>

</html>
